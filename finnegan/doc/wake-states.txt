STATE DIAGRAM
=============

          ------------------------
          |                      |
          |           -------|   |
          |           |      |   |
          |           |  /->[S]  |
          v           v /        |
-->[N]-->[I]-->[P]-->[A]--->[U]--|
          ^     ^    / \         
          |     -----   \->[T]
          |                 |
          -------------------

STATES
======

(N)ew
-----
Meaning: The wake was added to the system, but has not been initialized by the daemon yet.
Database indicators: ISNULL(next_trigger_time)
Trasitions:
	I: Achieved when the finnegan daemon initializes all new wakes at the top of its event loop.
		next_trigger_time is set.

(I)nactive
----------
Meaning: The 'resting' state of a wake.  The wake shouldn't be activated yet.
Database indicators: next_trigger_time > NOW() AND ISNULL(this_trigger_time)
Transitions:
	P: Achieved by the finnegan daemon launching the call script.
		this_trigger_time is set
		this_unreachable_count is zeroed
		this_timeout_count is zeroed
		this_post_count is zeroed

(P)OST to the phone
-------------------
Meaning: Finnegan directs the phone to make noise and do display-fu
Transitions:
	A: After POST is sent, goes to A
		this_post_count is incremented

(A)ctive
--------
Meaning: The wake was activated, and we're waiting for a response from the user.
Database indicators: NOT ISNULL(next_trigger_time) AND NOT ISNULL(this_trigger_time)
Transitions:
	A: Achieved when this_trigger_time + message_length*this_post_count < NOW()
	S: Achieved by the user hitting the snooze.php page via phone softbutton.
		next_trigger_time is set (+9min)
		this_trigger_time is cleared
	U: An error condition in the call script.
		this_unreachable_count is incremented
		next_trigger_time is set (based on value of this_unreachable_count)
		this_trigger_time is cleared
	T: An error condition generated by lack of response from user.
		this_timeout_count is incremented
		next_trigger_time is set (based on value of this_timeout_count)
		this_trigger_time is cleared

(S)nooze
(U)nreachable
(T)imeout
